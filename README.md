# ü§ñ LLM Call Center Agent

[![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)](https://python.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)](https://fastapi.tiangolo.com)
[![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4-orange.svg)](https://openai.com)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue.svg)](https://docker.com)

**–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –∫–æ–ª–ª-—Ü–µ–Ω—Ç—Ä–∞** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π OpenAI GPT –º–æ–¥–µ–ª–µ–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –¥–∏–∞–ª–æ–≥–∞–º–∏.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üß† **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞, –ø—Ä–æ–¥–∞–∂–∏, –∂–∞–ª–æ–±—ã, –æ–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏**: –ø–∞–º—è—Ç—å –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–∏
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã**: —Ä–∞–∑–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ö° **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –Ω–∞ –±–∞–∑–µ FastAPI
- **–¢–æ—á–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤** –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –º–æ–¥—É–ª—å `optimizer.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–µ–π –∏ —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### üèóÔ∏è **Production-ready –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- **–¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π mypy
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å structlog
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

## üìö –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ üéØ api/v1/              # REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ dialogue.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ health.py          # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ metrics.py         # –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ router.py          # –†–æ—É—Ç–∏–Ω–≥ API
‚îú‚îÄ‚îÄ üß† core/               # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ client.py          # OpenAI API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ manager.py         # –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—Å–∏–π –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ metrics.py         # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ optimizer.py       # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ prompts.py         # –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤
‚îú‚îÄ‚îÄ üìä models/             # Pydantic –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ dialogue.py        # –ú–æ–¥–µ–ª–∏ –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ enums.py          # –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ requests.py        # –ú–æ–¥–µ–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ metrics_response.py # –ú–æ–¥–µ–ª–∏ –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ üîß services/           # –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ dialogue_service.py      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ classification_service.py # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ üíæ storage/            # –°–ª–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ memory.py          # –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏
‚îî‚îÄ‚îÄ üõ†Ô∏è utils/             # –£—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ exceptions.py      # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    ‚îî‚îÄ‚îÄ logger.py          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

### üîÑ –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

```mermaid
graph TD
    A[üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[üåê FastAPI]
    B --> C[üéØ Dialogue Service]
    C --> D{ü§î –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ?}
    D -->|–î–∞| E[üß† –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è]
    D -->|–ù–µ—Ç| F[üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞]
    E --> G[üìä –ú–µ—Ç—Ä–∏–∫–∏: –Ω–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏]
    G --> F
    F --> H[ü§ñ OpenAI API]
    H --> I[üí∞ –ü–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤]
    I --> J[üìä –ú–µ—Ç—Ä–∏–∫–∏: –æ—Ç–≤–µ—Ç]
    J --> K[üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Å–µ—Å—Å–∏–∏]
    K --> L[üì§ –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é]
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.11+**
- **Poetry** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- **OpenAI API –∫–ª—é—á**

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:**
```bash
git clone https://github.com/softkisik228/LLM-Callcenter-Agent.git
cd llm-callcenter-agent
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
poetry install
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
OPENAI_API_KEY=sk-–≤–∞—à-–∫–ª—é—á-openai

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
OPENAI_MODEL=gpt-4-1106-preview
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=1000
OPENAI_TIMEOUT=30
LOG_LEVEL=INFO
```

4. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env —Ñ–∞–π–ª–∞
poetry run uvicorn app.main:app --reload

# –ò–ª–∏ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ö–æ—Å—Ç–∞ –∏ –ø–æ—Ä—Ç–∞
poetry run uvicorn app.main:app --reload --host ${HOST:-0.0.0.0} --port ${PORT:-8000}
```

5. **–û—Ç–∫—Ä—ã—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API:**
```
http://localhost:8000/docs
```

### üê≥ –ó–∞–ø—É—Å–∫ —Å Docker

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f app
```

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### 1. üé¨ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –¥–∏–∞–ª–æ–≥–∞

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST "http://localhost:8000/api/v1/dialogue/start" \
  -H "Content-Type: application/json" \
  -d '{
    "customer_id": "user_12345",
    "customer_name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "initial_message": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—Ö–æ–¥–æ–º –≤ –∞–∫–∫–∞—É–Ω—Ç",
    "priority": "high",
    "metadata": {
      "source": "web_chat",
      "user_agent": "Chrome/119.0"
    }
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "session_id": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
  "message": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ò–≤–∞–Ω! –Ø –ø–æ–º–æ–≥—É –≤–∞–º —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –≤—Ö–æ–¥–æ–º –≤ –∞–∫–∫–∞—É–Ω—Ç. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞?",
  "request_type": "tech_support",
  "confidence": 0.95,
  "response_time_ms": 1250,
  "suggestions": []
}
```

### 2. üí¨ –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST "http://localhost:8000/api/v1/dialogue/f47ac10b-58cc-4372-a567-0e02b2c3d479/message" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–Ø –∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å –∏ –Ω–µ –º–æ–≥—É –µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å",
    "metadata": {
      "timestamp": "2024-01-15T10:30:00Z"
    }
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "session_id": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
  "message": "–ü–æ–Ω–∏–º–∞—é –ø—Ä–æ–±–ª–µ–º—É. –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:\n1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞\n2. –ù–∞–∂–º–∏—Ç–µ '–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?'\n3. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à email\n4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É (–≤–∫–ª—é—á–∞—è —Å–ø–∞–º)\n\n–ù–∞ –∫–∞–∫–æ–π email –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç?",
  "request_type": "tech_support",
  "confidence": 0.95,
  "response_time_ms": 980,
  "suggestions": []
}
```

### 3. ‚≠ê –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST "http://localhost:8000/api/v1/dialogue/f47ac10b-58cc-4372-a567-0e02b2c3d479/feedback" \
  -H "Content-Type: application/json" \
  -d '{
    "satisfaction_score": 4.5
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "Feedback recorded successfully"
}
```

### 4. üìã –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Å—Å–∏–∏

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X GET "http://localhost:8000/api/v1/dialogue/f47ac10b-58cc-4372-a567-0e02b2c3d479"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "session_id": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
  "status": "active",
  "message_count": 4,
  "request_type": "tech_support",
  "created_at": "2024-01-15T10:28:30.123456",
  "updated_at": "2024-01-15T10:35:15.789012"
}
```

### 5. üìä –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Å–∏—Å—Ç–µ–º—ã

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X GET "http://localhost:8000/api/metrics/metrics"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "total_sessions": 156,
  "avg_response_time_ms": 1180.5,
  "total_tokens_used": 45230,
  "total_cost_usd": 0.7834,
  "avg_satisfaction": 4.2,
  "classification_accuracy": 0.92
}
```

### 6. üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X GET "http://localhost:8000/api/v1/dialogue/f47ac10b-58cc-4372-a567-0e02b2c3d479/messages?limit=10"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "session_id": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
  "messages": [
    {
      "id": "msg_001",
      "role": "user",
      "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—Ö–æ–¥–æ–º –≤ –∞–∫–∫–∞—É–Ω—Ç",
      "timestamp": "2024-01-15T10:28:30.123456",
      "metadata": {}
    },
    {
      "id": "msg_002", 
      "role": "assistant",
      "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ò–≤–∞–Ω! –Ø –ø–æ–º–æ–≥—É –≤–∞–º —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É...",
      "timestamp": "2024-01-15T10:28:31.373456",
      "metadata": {}
    }
  ]
}
```

## üéõÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `APP_NAME` | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `LLM Call Center Agent` |
| `APP_VERSION` | –í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `0.1.0` |
| `DEBUG` | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ | `false` |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `INFO` |
| `HOST` | –•–æ—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | `0.0.0.0` |
| `PORT` | –ü–æ—Ä—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | `8000` |
| `WORKERS` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ | `1` |
| `OPENAI_API_KEY` | API –∫–ª—é—á OpenAI (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) | - |
| `OPENAI_MODEL` | –ú–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ | `gpt-4-1106-preview` |
| `OPENAI_MAX_TOKENS` | –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ | `1000` |
| `OPENAI_TEMPERATURE` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (0.0-2.0) | `0.7` |
| `OPENAI_TIMEOUT` | –¢–∞–π–º–∞—É—Ç –¥–ª—è OpenAI API (—Å–µ–∫) | `30` |

> **üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
> - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `HOST`, `PORT`, `WORKERS` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
> - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `APP_NAME`, `APP_VERSION`, `DEBUG` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
> - –í—Å–µ OpenAI –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
> - –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `LOG_LEVEL` —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### üîß **Tech Support** (–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- **–ü—Ä–æ–º–ø—Ç**: –ü–æ—à–∞–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è, —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- **–ü—Ä–∏–º–µ—Ä—ã**: "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", "–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ"

#### üí∞ **Sales** (–ü—Ä–æ–¥–∞–∂–∏) 
- **–ü—Ä–æ–º–ø—Ç**: –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π
- **–ü—Ä–∏–º–µ—Ä—ã**: "–ö–∞–∫–∏–µ —É –≤–∞—Å —Ç–∞—Ä–∏—Ñ—ã?", "–•–æ—á—É –∫—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"

#### üò† **Complaint** (–ñ–∞–ª–æ–±—ã)
- **–ü—Ä–æ–º–ø—Ç**: –≠–º–ø–∞—Ç–∏—è, –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ, –ø–æ–∏—Å–∫ —Ä–µ—à–µ–Ω–∏–π
- **–ü—Ä–∏–º–µ—Ä—ã**: "–û—á–µ–Ω—å –Ω–µ–¥–æ–≤–æ–ª–µ–Ω —Å–µ—Ä–≤–∏—Å–æ–º", "–¢—Ä–µ–±—É—é –≤–æ–∑–≤—Ä–∞—Ç –¥–µ–Ω–µ–≥"

#### ‚ùì **General** (–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã)
- **–ü—Ä–æ–º–ø—Ç**: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ –Ω—É–∂–Ω–æ–º—É –æ—Ç–¥–µ–ª—É
- **–ü—Ä–∏–º–µ—Ä—ã**: "–ö–∞–∫ –¥–µ–ª–∞?", "–ì–¥–µ –≤–∞—à –æ—Ñ–∏—Å?"

## üéØ –ú–æ–¥—É–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (Optimizer)

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (`app/core/optimizer.py`), –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ API –≤—ã–∑–æ–≤—ã.

### üöÄ **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞**

#### üíæ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ (TTL)
- –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏

#### üß† **–£–º–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –º–æ—â–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### ‚ö° **–°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ

#### üí∞ **–ö–∞–ª—å–∫—É–ª—è—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏**
- –¢–æ—á–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π OpenAI
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤

### üõ†Ô∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞**

**–í–∞–∂–Ω–æ**: –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥—É–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫. –°–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–¥:

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
enable_caching = getattr(settings, "enable_caching", False)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: False
cost_optimization = getattr(settings, "cost_optimization", False)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: False
cache_ttl = getattr(settings, "cache_ttl", 3600)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1 —á–∞—Å
max_context_messages = getattr(settings, "max_context_messages", 10)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10
openai_model_fast = getattr(settings, "openai_model_fast", settings.openai_model)  # Fallback –∫ –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥–µ–ª–∏
```

**–î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –≤ –∫–ª–∞—Å—Å `Settings` –≤ —Ñ–∞–π–ª–µ `app/config.py`:

```python
# –í app/config.py
class Settings(BaseSettings):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    # –û–ø—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    enable_caching: bool = False
    cost_optimization: bool = False
    cache_ttl: int = 3600
    max_context_messages: int = 10
    openai_model_fast: str = "gpt-3.5-turbo-1106"
```

### üìã **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

```python
from app.core.optimizer import optimizer

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
optimal_model = optimizer.select_optimal_model(session)

# –°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
compressed_messages = optimizer.compress_context(messages)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –ø–µ—Ä–µ–¥ API –≤—ã–∑–æ–≤–æ–º
cache_key = optimizer.get_cache_key(messages, model, temperature)
cached_response = optimizer.get_cached_response(cache_key)

if cached_response:
    response, tokens, cost = cached_response
else:
    # –í—ã–ø–æ–ª–Ω–∏—Ç—å API –∑–∞–ø—Ä–æ—Å
    response = await client.generate_response(...)
    # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à
    optimizer.cache_response(cache_key, response, tokens, cost)
```

### üìä **–ú–µ—Ç—Ä–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
- **–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∫—ç—à** (cache hit rate)
- **–≠–∫–æ–Ω–æ–º–∏—é —Å—Ä–µ–¥—Å—Ç–≤** –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é
- **–í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π** –∏ –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- **–°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** –∏ —ç–∫–æ–Ω–æ–º–∏—é —Ç–æ–∫–µ–Ω–æ–≤

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **–°–µ—Å—Å–∏–∏**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- **–ö–∞—á–µ—Å—Ç–≤–æ**: –¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–ó–∞—Ç—Ä–∞—Ç—ã**: –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –º–æ–¥–µ–ª—è–º

### Health Check —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

```bash
# –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl http://localhost:8000/api/health

# –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl http://localhost:8000/api/health/detailed
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry install

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
poetry run mypy .

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
poetry run black .
poetry run isort .

# –õ–∏–Ω—Ç–∏–Ω–≥
poetry run ruff check .

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–Ω—Ç–∏–Ω–≥–∞
poetry run ruff check . --fix
```


## üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t llm-callcenter-agent .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 \
  -e OPENAI_API_KEY=sk-–≤–∞—à-–∫–ª—é—á \
  -e OPENAI_MODEL=gpt-4-1106-preview \
  -e OPENAI_TIMEOUT=30 \
  -e LOG_LEVEL=INFO \
  llm-callcenter-agent
```

### Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  app:
    image: llm-callcenter-agent:latest
    ports:
      - "${PORT:-8000}:${PORT:-8000}"
    environment:
      - APP_NAME=${APP_NAME:-LLM Call Center Agent}
      - APP_VERSION=${APP_VERSION:-0.1.0}
      - DEBUG=${DEBUG:-false}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - HOST=${HOST:-0.0.0.0}
      - PORT=${PORT:-8000}
      - WORKERS=${WORKERS:-1}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - OPENAI_MODEL=${OPENAI_MODEL:-gpt-4-1106-preview}
      - OPENAI_MAX_TOKENS=${OPENAI_MAX_TOKENS:-1000}
      - OPENAI_TEMPERATURE=${OPENAI_TEMPERATURE:-0.7}
      - OPENAI_TIMEOUT=${OPENAI_TIMEOUT:-30}
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:${PORT:-8000}/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE)
